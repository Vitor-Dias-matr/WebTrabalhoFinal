"use strict";var appZipCode=function(){var e={form:"[data-zip-code-form",input:"[data-zip-code-input]",btn_submit:"[data-zip-code-submit]",err_class:".zip__code-err",fail_class:".zip__code-fail-err",empty_class:".zip__code-empty",open_lightbox_freigth:"section.zipcode-content",container:".zipcode-content .zip__code--container",box_input:".zip__code-box",overlay:"overlay.display",tooltip:".zip__code--tooltip",login:".zip__code-user"},t=document.querySelector("section[data-free-shipping-by-zipcode]"),o=document.querySelector("section[data-get-zipcode-info]"),c=dataLayer[0].page?dataLayer[0].page.pageID.toLowerCase():"others",n=function(){document.querySelector(e.input).addEventListener("keyup",function(e){var t=e.target.value.replace(/[^\d]+/g,"");t=t.replace(/(\d{5})(\d)/,"$1-$2"),e.target.value=t})},i=function(t){document.querySelector(e.input).value=t.replace(/(\d{5})(\d)/,"$1-$2")},r=function(){return document.querySelector("html").getAttribute("lang")},u=function(e){return e.replace(/(\d{5})(\d)/,"$1-$2")},d=function(e){var t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?t[2]:null},s=function(){var t="";return t=null!==d("zipcode")?d("zipcode"):document.querySelector(e.input).value,u(t)},a=function(e){document.querySelector(".text").classList.add("hide");var t=document.querySelector(".text__sucess"),o=t.querySelector("span");o&&(o.innerText=u(e)),t.classList.remove("hide"),document.querySelector(".zipcode-content__block--text")?(document.querySelector(".zipcode-content__block--text").innerHTML='Enviar para: <span class="zipcode-value">'+u(e)+"</span>",document.querySelector(".zipcode-content__block--text").classList.add("filled")):document.querySelector(".zipcode-content__text").innerHTML="Enviar para <span class='zipcode-value'>"+u(e)+"</span>"},l=function(){var t=document.querySelector(e.input),o=document.querySelector(e.login);t.closest(".zip__code-box").classList.add("hide"),o.classList.add("hide"),t=t.value.replace(/[^\d]+/g,"");var c=document.querySelector(e.btn_submit),n=c?c.querySelector("span"):null;n&&(n.innerText="OK");var i=new Date;i.setMonth(i.getMonth()+1);var r="expires="+i.toUTCString();document.cookie="zipcode="+t+";"+r+";path=/",window.freedom.nsPubSub.pub("zipcodeCookie.reinit"),a(t)},p=function(t){t?""!==document.querySelector(e.input).value?(document.querySelector(e.err_class).classList.remove("hide"),document.querySelector(e.empty_class).classList.add("hide"),document.querySelector(e.fail_class).classList.add("hide")):(document.querySelector(e.err_class).classList.add("hide"),document.querySelector(e.fail_class).classList.add("hide"),document.querySelector(e.empty_class).classList.remove("hide")):(document.querySelector(e.err_class).classList.add("hide"),document.querySelector(e.empty_class).classList.add("hide"),document.querySelector(e.fail_class).classList.add("hide"),l())},m=function(e,t){if(""!==e){var o=e.replace(/\D/g,""),c=/^[0-9]{8}$/;return"es-AR"===t?c=/^[0-9]{4}$/:"es-MX"===t&&(c=/^[0-9]{5}$/),c.test(o)}return!1},b=function(){""!==document.querySelector(e.input).value?document.querySelector(e.box_input+" label").classList.remove("hide"):document.querySelector(e.box_input+" label").classList.add("hide")},y=!0,S=function(){y&&(y=!1,document.querySelector(e.input).addEventListener("input",function(){b()}),document.querySelector(e.input).addEventListener("blur",function(){b()}))},f=function(){document.querySelector(".text__sucess").classList.add("hide"),document.querySelector(".text").classList.remove("hide"),document.querySelector(".zip__code-box").classList.remove("hide"),document.querySelector(e.input).setAttribute("value",s()),document.querySelector(e.box_input+" label").classList.remove("hide"),d("uname")?document.querySelector(e.login).classList.add("hide"):document.querySelector(e.login).classList.remove("hide")},v=function(){document.querySelector(e.open_lightbox_freigth).addEventListener("click",function(){var t=document.querySelector(e.btn_submit),o=t?t.querySelector("span"):null;d("zipcode")?(f(),o&&(o.innerText="Alterar")):(f(),o&&(o.innerText="Consultar")),window.freedom.nsPubSub.pub(e.overlay,"show"),document.querySelector(e.container).classList.remove("hide")});var n=function(){var t=document.querySelector("button[data-zip-code-submit] span");document.querySelector(e.container).classList.add("hide"),window.freedom.nsPubSub.pub(e.overlay,"hide"),t&&(t.innerText="ALTERAR"),document.querySelector(e.tooltip)&&(document.querySelector(e.tooltip).classList.remove("hide"),setTimeout(function(){document.querySelector(e.tooltip).classList.add("hide")},5e3))};document.querySelector(e.btn_submit).addEventListener("click",function(i){var u=this.querySelector(".text");if(i.preventDefault(),i.stopPropagation(),u&&"OK"===u.innerText){if(n(),t||o){var s=d("zipcode");window.freedom.nsPubSub.pub("checkFreeShippingEligibility",s),window.freedom.nsPubSub.pub("getZipcodeFullInfo",s),window.freedom.nsPubSub.pub("nsLoading.show",document.body),window.zipcodeAPIsAjax=!1,"product"===c&&window.freedom.nsPubSub.pub("Shipping.restart")}}else{var a=document.querySelector(e.input).value,l=r();p(m(a,l)?!1:!0)}}),window.freedom.live("#overlay","click",function(){var n=document.querySelector(".zip__code--calculate .text");if(window.freedom.nsPubSub.pub(e.overlay,"hide"),document.querySelector(e.container).classList.add("hide"),n&&"OK"===n.innerText&&(t||o)){var i=d("zipcode");window.freedom.nsPubSub.pub("checkFreeShippingEligibility",i),window.freedom.nsPubSub.pub("getZipcodeFullInfo",i),window.freedom.nsPubSub.pub("nsLoading.show",document.body),window.zipcodeAPIsAjax=!1,"product"===c&&window.freedom.nsPubSub.pub("Shipping.restart")}}),window.freedom.live(e.input,"click",function(){S()})};try{if(v(),n(),d("zipcode")){var _=d("zipcode");a(_)}window.freedom.nsPubSub.sub("changeHeaderZipcode",a),window.freedom.nsPubSub.sub("changeHeaderZipcode",i)}catch(h){console.error("ERROR | Shipping "+h)}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl9yZWZhY3RvcmluZy9fY29tcG9uZW50cy9pbnNlcnQtemlwLWNvZGUvYWxsL2luc2VydC16aXAtY29kZS5taW4uanMiXSwibmFtZXMiOlsiYXBwWmlwQ29kZSIsIiRlbGVtIiwiZm9ybSIsImlucHV0IiwiYnRuX3N1Ym1pdCIsImVycl9jbGFzcyIsImZhaWxfY2xhc3MiLCJlbXB0eV9jbGFzcyIsIm9wZW5fbGlnaHRib3hfZnJlaWd0aCIsImNvbnRhaW5lciIsImJveF9pbnB1dCIsIm92ZXJsYXkiLCJ0b29sdGlwIiwibG9naW4iLCJjaGVja0ZyZWVTaGlwcGluZ0VuYWJsZWQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJnZXRaaXBjb2RlSW5mb0VuYWJsZWQiLCJwYWdlVHlwZSIsImRhdGFMYXllciIsInBhZ2UiLCJwYWdlSUQiLCJ0b0xvd2VyQ2FzZSIsImFwcGx5SW5wdXRNYWtzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJzdHIiLCJ0YXJnZXQiLCJ2YWx1ZSIsInJlcGxhY2UiLCJ1cGRhdGVJbnB1dFZhbHVlIiwiemlwY29kZSIsImdldENvdW50cnkiLCJnZXRBdHRyaWJ1dGUiLCJmb3JtYXRaaXBDb2RlIiwiZ2V0Q29va2llIiwiY2tuYW1lIiwiY29va2llIiwibWF0Y2giLCJnZXRaaXBDb2RlIiwibWVzc2FnZVN1Y2VzcyIsImNsYXNzTGlzdCIsImFkZCIsIm1zZ3N1Y2VzcyIsInNwYW4iLCJpbm5lclRleHQiLCJyZW1vdmUiLCJpbm5lckhUTUwiLCJzZXRaaXBDb2RlIiwibG9naW5MaW5rIiwiY2xvc2VzdCIsImJ0biIsImRhdGUiLCJEYXRlIiwic2V0TW9udGgiLCJnZXRNb250aCIsImV4cGlyZXMiLCJ0b1VUQ1N0cmluZyIsIndpbmRvdyIsImZyZWVkb20iLCJuc1B1YlN1YiIsInB1YiIsInZhbGlkYXRpb25DYWxsYmFjayIsImVycm9yIiwidmFsaWRhdGVaaXBjb2RlIiwieiIsImMiLCJyZWdleCIsInRlc3QiLCJoaWRlT3JTaG93TGFiZWwiLCJhdXhTZXRGb2N1cyIsIm9uZm9jdXMiLCJzaG93TW9kYWwiLCJzZXRBdHRyaWJ1dGUiLCJzZXRMaXN0ZW5lcnMiLCJjbG9zZUZvcm0iLCJzZXRUaW1lb3V0IiwidGV4dEVsIiwidGhpcyIsInByZXZlbnREZWZhdWx0Iiwic3RvcFByb3BhZ2F0aW9uIiwiemlwIiwiYm9keSIsInppcGNvZGVBUElzQWpheCIsImNvdW50cnkiLCJsaXZlIiwic3ViIiwiZXJyIiwiY29uc29sZSJdLCJtYXBwaW5ncyI6IkFBQUEsWUFFQSxJQUFJQSxZQUFjLFdBRWhCLEdBQUlDLElBQ0ZDLEtBQU0sc0JBQ05DLE1BQU8sd0JBQ1BDLFdBQVkseUJBQ1pDLFVBQVcsaUJBQ1hDLFdBQVksc0JBQ1pDLFlBQWEsbUJBQ2JDLHNCQUF1QiwwQkFDdkJDLFVBQVcseUNBQ1hDLFVBQVcsaUJBQ1hDLFFBQVMsa0JBQ1RDLFFBQVMsc0JBQ1RDLE1BQU8sbUJBRUxDLEVBQTJCQyxTQUFTQyxjQUFjLDBDQUNwREMsRUFBd0JGLFNBQVNDLGNBQWMsa0NBQy9DRSxFQUFZQyxVQUFVLEdBQU8sS0FBSUEsVUFBVSxHQUFHQyxLQUFLQyxPQUFPQyxjQUFnQixTQU94RUMsRUFBaUIsV0FDbkJSLFNBQVNDLGNBQWNmLEVBQU1FLE9BQU9xQixpQkFBaUIsUUFBUyxTQUFTQyxHQUNyRSxHQUFJQyxHQUFNRCxFQUFFRSxPQUFPQyxNQUFNQyxRQUFRLFVBQVcsR0FDNUNILEdBQU1BLEVBQUlHLFFBQVEsY0FBZSxTQUNqQ0osRUFBRUUsT0FBT0MsTUFBUUYsS0FTakJJLEVBQW1CLFNBQVVDLEdBQy9CaEIsU0FBU0MsY0FBY2YsRUFBTUUsT0FBT3lCLE1BQVFHLEVBQVFGLFFBQVEsY0FBZSxVQVF6RUcsRUFBYSxXQUNmLE1BQU9qQixVQUFTQyxjQUFjLFFBQVFpQixhQUFhLFNBUWpEQyxFQUFnQixTQUFTSCxHQUMzQixNQUFPQSxHQUFRRixRQUFRLGNBQWUsVUFRcENNLEVBQVksU0FBU0MsR0FDdkIsR0FBSUwsR0FBVWhCLFNBQVNzQixPQUFP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RHZCLE9BQU9DLFFBQVFDLFNBQVNDLElBQUksaUJBQWtCOUMsU0FBU21FLE1BQ3ZEeEIsT0FBT3lCLGlCQUFrQixFQUNSLFlBQWJqRSxHQUNGd0MsT0FBT0MsUUFBUUMsU0FBU0MsSUFBSSx1QkFPcENILE9BQU9DLFFBQVEwQixLQUFLcEYsRUFBTUUsTUFBTyxRQUFTLFdBQ3hDb0UsTUFLSixLQUlFLEdBSEFHLElBQ0FuRCxJQUVJWSxFQUFVLFdBQVksQ0FDeEIsR0FBSUosR0FBVUksRUFBVSxVQUN4QkssR0FBY1QsR0FHaEIyQixPQUFPQyxRQUFRQyxTQUFTMEIsSUFBSSxzQkFBdUI5QyxHQUNuRGtCLE9BQU9DLFFBQVFDLFNBQVMwQixJQUFJLHNCQUF1QnhELEdBRW5ELE1BQU95RCxHQUNQQyxRQUFRekIsTUFBTSxvQkFBc0J3QiIsImZpbGUiOiJfcmVmYWN0b3JpbmcvX2NvbXBvbmVudHMvaW5zZXJ0LXppcC1jb2RlL2FsbC9pbnNlcnQtemlwLWNvZGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXBwWmlwQ29kZSA9IChmdW5jdGlvbigpIHtcbiAgLy8gc2VsZXRvcmVzXG4gIHZhciAkZWxlbSA9IHtcbiAgICBmb3JtOiAnW2RhdGEtemlwLWNvZGUtZm9ybScsXG4gICAgaW5wdXQ6ICdbZGF0YS16aXAtY29kZS1pbnB1dF0nLFxuICAgIGJ0bl9zdWJtaXQ6ICdbZGF0YS16aXAtY29kZS1zdWJtaXRdJyxcbiAgICBlcnJfY2xhc3M6ICcuemlwX19jb2RlLWVycicsXG4gICAgZmFpbF9jbGFzczogJy56aXBfX2NvZGUtZmFpbC1lcnInLFxuICAgIGVtcHR5X2NsYXNzOiAnLnppcF9fY29kZS1lbXB0eScsXG4gICAgb3Blbl9saWdodGJveF9mcmVpZ3RoOiAnc2VjdGlvbi56aXBjb2RlLWNvbnRlbnQnLFxuICAgIGNvbnRhaW5lcjogJy56aXBjb2RlLWNvbnRlbnQgLnppcF9fY29kZS0tY29udGFpbmVyJyxcbiAgICBib3hfaW5wdXQ6ICcuemlwX19jb2RlLWJveCcsXG4gICAgb3ZlcmxheTogJ292ZXJsYXkuZGlzcGxheScsXG4gICAgdG9vbHRpcDogJy56aXBfX2NvZGUtLXRvb2x0aXAnLFxuICAgIGxvZ2luOiAnLnppcF9fY29kZS11c2VyJ1xuICB9O1xuICB2YXIgY2hlY2tGcmVlU2hpcHBpbmdFbmFibGVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcignc2VjdGlvbltkYXRhLWZyZWUtc2hpcHBpbmctYnktemlwY29kZV0nKSxcbiAgICBnZXRaaXBjb2RlSW5mb0VuYWJsZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdzZWN0aW9uW2RhdGEtZ2V0LXppcGNvZGUtaW5mb10nKSxcbiAgICBwYWdlVHlwZSA9IChkYXRhTGF5ZXJbMF0ucGFnZSkgPyBkYXRhTGF5ZXJbMF0ucGFnZS5wYWdlSUQudG9Mb3dlckNhc2UoKSA6ICdvdGhlcnMnO1xuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGFwcGx5SW5wdXRNYWtzXG4gICAqIGFwcGx5IHppcGNvZGUgbWFzayAwMDAwMC0wMDBcbiAgICogQHJldHVybiB7fVxuICAgKi9cbiAgdmFyIGFwcGx5SW5wdXRNYWtzID0gZnVuY3Rpb24oKSB7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigkZWxlbS5pbnB1dCkuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgc3RyID0gZS50YXJnZXQudmFsdWUucmVwbGFjZSgvW15cXGRdKy9nLCAnJyk7XG4gICAgICBzdHIgPSBzdHIucmVwbGFjZSgvKFxcZHs1fSkoXFxkKS8sIFwiJDEtJDJcIik7XG4gICAgICBlLnRhcmdldC52YWx1ZSA9IHN0cjtcbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogQG1ldGhvZCB1cGRhdGVJbnB1dFZhbHVlXG4gICAqIGFwcGx5IHppcGNvZGUgbWFzayAwMDAwMC0wMDBcbiAgICogQHJldHVybiB7fVxuICAgKi9cbiAgdmFyIHVwZGF0ZUlucHV0VmFsdWUgPSBmdW5jdGlvbiAoemlwY29kZSkge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJGVsZW0uaW5wdXQpLnZhbHVlID0gemlwY29kZS5yZXBsYWNlKC8oXFxkezV9KShcXGQpLywgXCIkMS0kMlwiKTtcbiAgfTtcblxuICAvKipcbiAgICogQG1ldGhvZCBnZXRDb3VudHJ5XG4gICAqIGdldCBjb3VudHJ5XG4gICAqIEByZXR1cm4ge3N0cmluZ30gW2NvdW50cnldXG4gICAqL1xuICB2YXIgZ2V0Q291bnRyeSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJykuZ2V0QXR0cmlidXRlKCdsYW5nJyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgZm9ybWF0WmlwQ29kZVxuICAgKiByZXR1cm4gemlwY29kZSBmb3JtYXQgMDAwMDAtMDAwXG4gICAqIEByZXR1cm4ge3N0cmluZ31cbiAgICovXG4gIHZhciBmb3JtYXRaaXBDb2RlID0gZnVuY3Rpb24oemlwY29kZSkge1xuICAgIHJldHVybiB6aXBjb2RlLnJlcGxhY2UoLyhcXGR7NX0pKFxcZCkvLCBcIiQxLSQyXCIpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGdldENvb2tpZVxuICAgKiBnZXQgY29va2llIGJ5IG5hbWVcbiAgICogQHJldHVybiB7c3RyaW5nfSBbemlwY29kZV1cbiAgICovXG4gIHZhciBnZXRDb29raWUgPSBmdW5jdGlvbihja25hbWUpIHtcbiAgICB2YXIgemlwY29kZSA9IGRvY3VtZW50LmNvb2tpZS5tYXRjaCgnKF58OykgPycgKyBja25hbWUgKyAnPShbXjtdKikoO3wkKScpO1xuICAgIHJldHVybiB6aXBjb2RlID8gemlwY29kZVsyXSA6IG51bGw7XG4gIH07XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgZ2V0WmlwQ29kZVxuICAgKiBnZXQgemlwY29kZVxuICAgKiBAcmV0dXJuIHtzdHJpbmd9IFt6aXBjb2RlXVxuICAgKi9cbiAgdmFyIGdldFppcENvZGUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgemlwY29kZSA9ICcnO1xuXG4gICAgaWYgKGdldENvb2tpZSgnemlwY29kZScpICE9PSBudWxsKSB7XG4gICAgICB6aXBjb2RlID0gZ2V0Q29va2llKCd6aXBjb2RlJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHppcGNvZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCRlbGVtLmlucHV0KS52YWx1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZm9ybWF0WmlwQ29kZSh6aXBjb2RlKTtcbiAgfTtcblxuICAvKipcbiAgICogQG1ldGhvZCBtZXNzYWdlU3VjZXNzXG4gICAqIHNob3cgYm94IHN1Y2VzcyBtZXNzYWdlXG4gICAqIEByZXR1cm4ge31cbiAgICovXG4gIHZhciBtZXNzYWdlU3VjZXNzID0gZnVuY3Rpb24oemlwY29kZSkge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZXh0JykuY2xhc3NMaXN0LmFkZCgnaGlkZScpO1xuXG4gICAgdmFyIG1zZ3N1Y2VzcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZXh0X19zdWNlc3MnKTtcbiAgICB2YXIgc3BhbiA9IG1zZ3N1Y2Vzcy5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XG5cbiAgICBpZiAoc3Bhbikge1xuICAgICAgc3Bhbi5pbm5lclRleHQgPSBmb3JtYXRaaXBDb2RlKHppcGNvZGUpO1xuICAgIH1cblxuICAgIG1zZ3N1Y2Vzcy5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJyk7XG4gICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy56aXBjb2RlLWNvbnRlbnRfX2Jsb2NrLS10ZXh0JykpIHtcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy56aXBjb2RlLWNvbnRlbnRfX2Jsb2NrLS10ZXh0JykuaW5uZXJIVE1MID0gJ0VudmlhciBwYXJhOiA8c3BhbiBjbGFzcz1cInppcGNvZGUtdmFsdWVcIj4nICsgZm9ybWF0WmlwQ29kZSh6aXBjb2RlKSArICc8L3NwYW4+JztcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy56aXBjb2RlLWNvbnRlbnRfX2Jsb2NrLS10ZXh0JykuY2xhc3NMaXN0LmFkZCgnZmlsbGVkJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy56aXBjb2RlLWNvbnRlbnRfX3RleHQnKS5pbm5lckhUTUwgPSBcIkVudmlhciBwYXJhIDxzcGFuIGNsYXNzPSd6aXBjb2RlLXZhbHVlJz5cIiArIGZvcm1hdFppcENvZGUoemlwY29kZSkgKyAnPC9zcGFuPic7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBAbWV0aG9kIHNldFppcENvZGVcbiAgICogc2F2ZSBjb29raWUgemlwY29kZVxuICAgKiBAcmV0dXJuIHt9XG4gICAqL1xuICB2YXIgc2V0WmlwQ29kZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB6aXBjb2RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigkZWxlbS5pbnB1dCksXG4gICAgICBsb2dpbkxpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCRlbGVtLmxvZ2luKTtcbiAgICB6aXBjb2RlLmNsb3Nlc3QoJy56aXBfX2NvZGUtYm94JykuY2xhc3NMaXN0LmFkZCgnaGlkZScpO1xuICAgIGxvZ2luTGluay5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XG4gICAgemlwY29kZSA9IHppcGNvZGUudmFsdWUucmVwbGFjZSgvW15cXGRdKy9nLCAnJyk7XG4gICAgdmFyIGJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJGVsZW0uYnRuX3N1Ym1pdCk7XG4gICAgdmFyIHNwYW4gPSBidG4gPyBidG4ucXVlcnlTZWxlY3Rvcignc3BhbicpIDogbnVsbDtcblxuICAgIGlmIChzcGFuKSB7XG4gICAgICBzcGFuLmlubmVyVGV4dCA9ICdPSyc7XG4gICAgfVxuXG4gICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIGRhdGUuc2V0TW9udGgoZGF0ZS5nZXRNb250aCgpICsgMSk7XG4gICAgdmFyIGV4cGlyZXMgPSAnZXhwaXJlcz0nICsgZGF0ZS50b1VUQ1N0cmluZygpO1xuICAgIGRvY3VtZW50LmNvb2tpZSA9ICd6aXBjb2RlJyArICc9JyArIHppcGNvZGUgKyAnOycgKyBleHBpcmVzICsgJztwYXRoPS8nO1xuXG4gICAgd2luZG93LmZyZWVkb20ubnNQdWJTdWIucHViKCd6aXBjb2RlQ29va2llLnJlaW5pdCcpO1xuXG4gICAgbWVzc2FnZVN1Y2Vzcyh6aXBjb2RlKTtcbiAgfTtcblxuICAvKipcbiAgICogQG1ldGhvZCB2YWxpZGF0aW9uQ2FsbGJhY2tcbiAgICogY2hlY2sgZm9yIGZpZWxkIGVycm9yXG4gICAqIEBwYXJhbSAge2Jvb2xlYW59IGVycm9yXG4gICAqIEByZXR1cm4ge31cbiAgICovXG4gIHZhciB2YWxpZGF0aW9uQ2FsbGJhY2sgPSBmdW5jdGlvbihlcnJvcikge1xuICAgIGlmIChlcnJvcikge1xuICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJGVsZW0uaW5wdXQpLnZhbHVlICE9PSBcIlwiKSB7XG5cbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigkZWxlbS5lcnJfY2xhc3MpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKTtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigkZWxlbS5lbXB0eV9jbGFzcykuY2xhc3NMaXN0LmFkZCgnaGlkZScpO1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCRlbGVtLmZhaWxfY2xhc3MpLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigkZWxlbS5lcnJfY2xhc3MpLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigkZWxlbS5mYWlsX2NsYXNzKS5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJGVsZW0uZW1wdHlfY2xhc3MpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKTtcbiAgICAgIH1cblxuICAgIH0gZWxzZSB7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCRlbGVtLmVycl9jbGFzcykuY2xhc3NMaXN0LmFkZCgnaGlkZScpO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigkZWxlbS5lbXB0eV9jbGFzcykuY2xhc3NMaXN0LmFkZCgnaGlkZScpO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigkZWxlbS5mYWlsX2NsYXNzKS5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XG4gICAgICBzZXRaaXBDb2RlKCk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBAbWV0aG9kIHZhbGlkYXRlWmlwY29kZVxuICAgKiB0ZXN0IHRvIHZhbGlkYXRlIGlmIHRoZSBpbnB1dCB6aXBjb2RlIGlzIHZhbGlkIGFjY29yZGluZyB0byB0aGUgbnVtYmVyIG9mIGNoYXJhY3RlcnNcbiAgICogQHBhcmFtICB7c3RyaW5nfSB6IFt6aXBjb2RlXVxuICAgKiBAcGFyYW0gIHtzdHJpbmd9IGMgW2NvdW50cnldXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IFt0cnVlIG9yIGZhbHNlXVxuICAgKi9cbiAgdmFyIHZhbGlkYXRlWmlwY29kZSA9IGZ1bmN0aW9uKHosIGMpIHtcbiAgICBpZiAoeiAhPT0gJycpIHtcbiAgICAgIC8vIFJlbW92ZXMgYW55IGNoYXJhY3RlciB0aGF0IGlzIG5vdCBhIGRpZ2l0IGNoYXJhY3RlciAoMC05KVxuICAgICAgdmFyIHppcGNvZGUgPSB6LnJlcGxhY2UoL1xcRC9nLCAnJyk7XG5cbiAgICAgIC8vIDggZGlnaXRzIDAgdG8gOVxuICAgICAgdmFyIHJlZ2V4ID0gL15bMC05XXs4fSQvO1xuXG4gICAgICAvLyA0IGRpZ2l0cyAwIHRvIDlcbiAgICAgIGlmIChjID09PSAnZXMtQVInKSB7XG4gICAgICAgIHJlZ2V4ID0gL15bMC05XXs0fSQvO1xuXG4gICAgICAgIC8vIDUgZGlnaXRzIDAgdG8gOVxuICAgICAgfSBlbHNlIGlmIChjID09PSAnZXMtTVgnKSB7XG4gICAgICAgIHJlZ2V4ID0gL15bMC05XXs1fSQvO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVnZXgudGVzdCh6aXBjb2RlKTtcblxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBAbWV0aG9kIGhpZGVPclNob3dMYWJlbFxuICAgKiBhdXggZm9yIGhpZGUvc2hvdyBsYWJlbCBvZiBpbnB1dFxuICAgKiBAcmV0dXJuIHt9XG4gICAqL1xuICB2YXIgaGlkZU9yU2hvd0xhYmVsID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJGVsZW0uaW5wdXQpLnZhbHVlICE9PSAnJykge1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigkZWxlbS5ib3hfaW5wdXQgKyAnIGxhYmVsJykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCRlbGVtLmJveF9pbnB1dCArICcgbGFiZWwnKS5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBAbWV0aG9kIG9uZm9jdXNcbiAgICogYWRkIGV2ZW50IHRvIGlucHV0IGZvY3VzXG4gICAqIFthdXhTZXRGb2N1c10gYXV4IGZvciBub3QgdG8gZHVwbGljYXRlIGV2ZW50c1xuICAgKiBAcmV0dXJuIHt9XG4gICAqL1xuICB2YXIgYXV4U2V0Rm9jdXMgPSB0cnVlO1xuICB2YXIgb25mb2N1cyA9IGZ1bmN0aW9uKCkge1xuICAgIGlmIChhdXhTZXRGb2N1cykge1xuICAgICAgYXV4U2V0Rm9jdXMgPSBmYWxzZTtcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJGVsZW0uaW5wdXQpLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGhpZGVPclNob3dMYWJlbCgpO1xuICAgICAgfSk7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCRlbGVtLmlucHV0KS5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGhpZGVPclNob3dMYWJlbCgpO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBzaG93TW9kYWwgPSBmdW5jdGlvbigpIHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGV4dF9fc3VjZXNzJykuY2xhc3NMaXN0LmFkZCgnaGlkZScpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZXh0JykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy56aXBfX2NvZGUtYm94JykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJGVsZW0uaW5wdXQpLnNldEF0dHJpYnV0ZSgndmFsdWUnLCBnZXRaaXBDb2RlKCkpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJGVsZW0uYm94X2lucHV0ICsgJyBsYWJlbCcpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKTtcbiAgICAoIWdldENvb2tpZSgndW5hbWUnKSkgPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCRlbGVtLmxvZ2luKS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJykgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCRlbGVtLmxvZ2luKS5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XG4gIH07XG5cbiAgdmFyIHNldExpc3RlbmVycyA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIGJ1dHRvbiBvcGVuIGxpZ2h0Ym94IGZyZWlndGhcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCRlbGVtLm9wZW5fbGlnaHRib3hfZnJlaWd0aCkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBidG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCRlbGVtLmJ0bl9zdWJtaXQpLFxuICAgICAgICBzcGFuID0gYnRuID8gYnRuLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKSA6IG51bGw7XG4gICAgICBpZiAoZ2V0Q29va2llKCd6aXBjb2RlJykpIHtcbiAgICAgICAgc2hvd01vZGFsKCk7XG4gICAgICAgIGlmIChzcGFuKSB7XG4gICAgICAgICAgc3Bhbi5pbm5lclRleHQgPSAnQWx0ZXJhcic7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNob3dNb2RhbCgpO1xuICAgICAgICBpZiAoc3Bhbikge1xuICAgICAgICAgIHNwYW4uaW5uZXJUZXh0ID0gJ0NvbnN1bHRhcic7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHdpbmRvdy5mcmVlZG9tLm5zUHViU3ViLnB1YigkZWxlbS5vdmVybGF5LCAnc2hvdycpO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigkZWxlbS5jb250YWluZXIpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKTtcbiAgICB9KTtcblxuICAgIC8vY2xvc2UgZm9ybSBhbmQgc2hvdyB0b29saXAsIHdoZW4gaXMgbW9iaWxlXG4gICAgdmFyIGNsb3NlRm9ybSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHNwYW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdidXR0b25bZGF0YS16aXAtY29kZS1zdWJtaXRdIHNwYW4nKTtcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJGVsZW0uY29udGFpbmVyKS5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XG4gICAgICB3aW5kb3cuZnJlZWRvbS5uc1B1YlN1Yi5wdWIoJGVsZW0ub3ZlcmxheSwgJ2hpZGUnKTtcblxuICAgICAgaWYgKHNwYW4pIHtcbiAgICAgICAgc3Bhbi5pbm5lclRleHQgPSBcIkFMVEVSQVJcIjtcbiAgICAgIH1cblxuICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJGVsZW0udG9vbHRpcCkpIHtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigkZWxlbS50b29sdGlwKS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJyk7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigkZWxlbS50b29sdGlwKS5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XG4gICAgICAgIH0sIDUwMDApO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBzdWJtaXRcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCRlbGVtLmJ0bl9zdWJtaXQpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIHRleHRFbCA9IHRoaXMucXVlcnlTZWxlY3RvcignLnRleHQnKTtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBpZiAodGV4dEVsICYmIHRleHRFbC5pbm5lclRleHQgPT09ICdPSycpIHtcbiAgICAgICAgY2xvc2VGb3JtKCk7XG4gICAgICAgIGlmIChjaGVja0ZyZWVTaGlwcGluZ0VuYWJsZWQgfHwgZ2V0WmlwY29kZUluZm9FbmFibGVkKSB7XG4gICAgICAgICAgdmFyIHppcCA9IGdldENvb2tpZSgnemlwY29kZScpO1xuICAgICAgICAgIHdpbmRvdy5mcmVlZG9tLm5zUHViU3ViLnB1YignY2hlY2tGcmVlU2hpcHBpbmdFbGlnaWJpbGl0eScsIHppcCk7XG4gICAgICAgICAgd2luZG93LmZyZWVkb20ubnNQdWJTdWIucHViKCdnZXRaaXBjb2RlRnVsbEluZm8nLCB6aXApO1xuICAgICAgICAgIHdpbmRvdy5mcmVlZG9tLm5zUHViU3ViLnB1YignbnNMb2FkaW5nLnNob3cnLCBkb2N1bWVudC5ib2R5KTtcbiAgICAgICAgICB3aW5kb3cuemlwY29kZUFQSXNBamF4ID0gZmFsc2U7XG4gICAgICAgICAgaWYgKHBhZ2VUeXBlID09PSAncHJvZHVjdCcpIHtcbiAgICAgICAgICAgIHdpbmRvdy5mcmVlZG9tLm5zUHViU3ViLnB1YignU2hpcHBpbmcucmVzdGFydCcpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHppcGNvZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCRlbGVtLmlucHV0KS52YWx1ZTtcbiAgICAgICAgdmFyIGNvdW50cnkgPSBnZXRDb3VudHJ5KCk7XG4gICAgICAgIHZhbGlkYXRlWmlwY29kZSh6aXBjb2RlLCBjb3VudHJ5KSA/IHZhbGlkYXRpb25DYWxsYmFjayhmYWxzZSkgOiB2YWxpZGF0aW9uQ2FsbGJhY2sodHJ1ZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBjbG9zZSAoYnV0dG9uIG9yIG92ZXJsYXkpXG4gICAgd2luZG93LmZyZWVkb20ubGl2ZSgnI292ZXJsYXknLCAnY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgIHZhciB0ZXh0RWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuemlwX19jb2RlLS1jYWxjdWxhdGUgLnRleHQnKTtcbiAgICAgIHdpbmRvdy5mcmVlZG9tLm5zUHViU3ViLnB1YigkZWxlbS5vdmVybGF5LCAnaGlkZScpO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigkZWxlbS5jb250YWluZXIpLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcbiAgICAgIGlmICh0ZXh0RWwgJiYgdGV4dEVsLmlubmVyVGV4dCA9PT0gJ09LJykge1xuICAgICAgICBpZiAoY2hlY2tGcmVlU2hpcHBpbmdFbmFibGVkIHx8IGdldFppcGNvZGVJbmZvRW5hYmxlZCkge1xuICAgICAgICAgIHZhciB6aXAgPSBnZXRDb29raWUoJ3ppcGNvZGUnKTtcbiAgICAgICAgICB3aW5kb3cuZnJlZWRvbS5uc1B1YlN1Yi5wdWIoJ2NoZWNrRnJlZVNoaXBwaW5nRWxpZ2liaWxpdHknLCB6aXApO1xuICAgICAgICAgIHdpbmRvdy5mcmVlZG9tLm5zUHViU3ViLnB1YignZ2V0WmlwY29kZUZ1bGxJbmZvJywgemlwKTtcbiAgICAgICAgICB3aW5kb3cuZnJlZWRvbS5uc1B1YlN1Yi5wdWIoJ25zTG9hZGluZy5zaG93JywgZG9jdW1lbnQuYm9keSk7XG4gICAgICAgICAgd2luZG93LnppcGNvZGVBUElzQWpheCA9IGZhbHNlO1xuICAgICAgICAgIGlmIChwYWdlVHlwZSA9PT0gJ3Byb2R1Y3QnKSB7XG4gICAgICAgICAgICB3aW5kb3cuZnJlZWRvbS5uc1B1YlN1Yi5wdWIoJ1NoaXBwaW5nLnJlc3RhcnQnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIGNhbGwgdG8gZXZlbnQgZm9jdXNcbiAgICB3aW5kb3cuZnJlZWRvbS5saXZlKCRlbGVtLmlucHV0LCAnY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgIG9uZm9jdXMoKTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBJbml0aWFsaXplIGFwcGxpY2F0aW9uXG4gIHRyeSB7XG4gICAgc2V0TGlzdGVuZXJzKCk7XG4gICAgYXBwbHlJbnB1dE1ha3MoKTtcblxuICAgIGlmIChnZXRDb29raWUoJ3ppcGNvZGUnKSkge1xuICAgICAgdmFyIHppcGNvZGUgPSBnZXRDb29raWUoJ3ppcGNvZGUnKTtcbiAgICAgIG1lc3NhZ2VTdWNlc3MoemlwY29kZSk7XG4gICAgfVxuXG4gICAgd2luZG93LmZyZWVkb20ubnNQdWJTdWIuc3ViKCdjaGFuZ2VIZWFkZXJaaXBjb2RlJywgbWVzc2FnZVN1Y2Vzcyk7XG4gICAgd2luZG93LmZyZWVkb20ubnNQdWJTdWIuc3ViKCdjaGFuZ2VIZWFkZXJaaXBjb2RlJywgdXBkYXRlSW5wdXRWYWx1ZSk7XG5cbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc29sZS5lcnJvcignRVJST1IgfCBTaGlwcGluZyAnICsgZXJyKTtcbiAgfVxufSgpKTtcbiJdfQ==
